
(*
 * dirov - produce an overview of a DIRCOUNT formatted area summary
 *
 *)



(* --------------------------------------------------------- *)
var
   boardname:  string;
   confname:   string;
   line:       string;
   oline:      string;
   fd:         text;
   i,deswid,k: integer;

begin
   if paramcount <> 2 then
   begin
      writeln('Usage: DIROV sumfile descwidth >outfile');
      writeln('Produces an overview of a report file generated by DIRCOUNT');
      writeln('Parameters:');
      writeln('   sumfile   specifies the input file, as produced by DIRCOUNT');
      writeln('   descwidth specifies the maximum width of descriptions');
      writeln('   outfile   specifies the output file for the overview');
      halt;
   end;

   assign(fd,paramstr(1));
   reset(fd);

   val(paramstr(2),deswid,k);

   readln(fd);
   readln(fd,boardname);

   readln(fd,confname);
   while copy(confname,1,1) = ' ' do
      delete(confname,1,1);

   if confname[1] = '[' then
   begin
      delete(confname,1,1);
      dec(confname[0]);
   end;

   while length(confname) < 40 do
      confname := confname + ' ';

   if (deswid > 35) or (deswid < 1) then
      deswid := 35;

   repeat
      readln(fd,line);

      if (length(line) = 73) and (line[6] in ['0'..'9']) then
      begin
         for i := 1 to length(line) do
            if line[i] = 'ú' then
               line[i] := ' ';
         oline := copy(line,4,3);
         if oline[1] = ' ' then
            delete(oline,1,1);
         oline := oline + '-' + copy(line,12,deswid+3-length(oline));

         while oline[length(oline)] = ' ' do
            dec(oline[0]);

       { if length(oline) > deswid+4 then
         begin
            oline[deswid+3] := '.';
            oline[deswid+4] := '.';
            oline[0] := chr(deswid+4);
         end; }

         writeln(oline);
      end;

   until eof(fd);
   close(fd);
end.

